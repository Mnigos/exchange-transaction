{"version":3,"sources":["../../src/transaction/transaction.service.spec.ts"],"sourcesContent":["import { type TestingModule, Test } from '@nestjs/testing'\n\nimport { TransactionService } from './transaction.service'\n\nimport { ExchangeRateService } from '~/exchange-rate'\n\ndescribe('TransactionService', () => {\n  let moduleRef: TestingModule\n  let transactionService: TransactionService\n  let exchangeRateService: ExchangeRateService\n\n  beforeEach(async () => {\n    moduleRef = await Test.createTestingModule({\n      providers: [\n        TransactionService,\n        {\n          provide: ExchangeRateService,\n          useValue: {\n            get: vi.fn(),\n          },\n        },\n      ],\n    }).compile()\n\n    transactionService = moduleRef.get(TransactionService)\n    exchangeRateService = moduleRef.get(ExchangeRateService)\n  })\n\n  afterEach(async () => {\n    await moduleRef.close()\n  })\n\n  test('should be defined', () => {\n    expect(transactionService).toBeDefined()\n  })\n\n  describe('create', () => {\n    test('should return exchange rate', async () => {\n      const exchangeRate = 4.5\n\n      const exchangeRateServiceGetSpy = vi\n        .spyOn(exchangeRateService, 'get')\n        .mockResolvedValue(exchangeRate)\n\n      expect(await transactionService.create(100)).toEqual({\n        exchangeRate,\n        amountInPln: 450,\n        amountInEur: 100,\n        timestamp: expect.any(Date),\n      })\n\n      expect(exchangeRateServiceGetSpy).toHaveBeenCalled()\n    })\n  })\n})\n"],"names":["describe","moduleRef","transactionService","exchangeRateService","beforeEach","Test","createTestingModule","providers","TransactionService","provide","ExchangeRateService","useValue","get","vi","fn","compile","afterEach","close","test","expect","toBeDefined","exchangeRate","exchangeRateServiceGetSpy","spyOn","mockResolvedValue","create","toEqual","amountInPln","amountInEur","timestamp","any","Date","toHaveBeenCalled"],"mappings":";;;;yBAAyC;oCAEN;8BAEC;AAEpCA,SAAS,sBAAsB;IAC7B,IAAIC;IACJ,IAAIC;IACJ,IAAIC;IAEJC,WAAW;QACTH,YAAY,MAAMI,aAAI,CAACC,mBAAmB,CAAC;YACzCC,WAAW;gBACTC,sCAAkB;gBAClB;oBACEC,SAASC,iCAAmB;oBAC5BC,UAAU;wBACRC,KAAKC,GAAGC,EAAE;oBACZ;gBACF;aACD;QACH,GAAGC,OAAO;QAEVb,qBAAqBD,UAAUW,GAAG,CAACJ,sCAAkB;QACrDL,sBAAsBF,UAAUW,GAAG,CAACF,iCAAmB;IACzD;IAEAM,UAAU;QACR,MAAMf,UAAUgB,KAAK;IACvB;IAEAC,KAAK,qBAAqB;QACxBC,OAAOjB,oBAAoBkB,WAAW;IACxC;IAEApB,SAAS,UAAU;QACjBkB,KAAK,+BAA+B;YAClC,MAAMG,eAAe;YAErB,MAAMC,4BAA4BT,GAC/BU,KAAK,CAACpB,qBAAqB,OAC3BqB,iBAAiB,CAACH;YAErBF,OAAO,MAAMjB,mBAAmBuB,MAAM,CAAC,MAAMC,OAAO,CAAC;gBACnDL;gBACAM,aAAa;gBACbC,aAAa;gBACbC,WAAWV,OAAOW,GAAG,CAACC;YACxB;YAEAZ,OAAOG,2BAA2BU,gBAAgB;QACpD;IACF;AACF"}